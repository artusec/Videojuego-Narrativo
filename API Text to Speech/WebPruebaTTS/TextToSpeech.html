<!DOCTYPE html>
<html>
    <header>
            <!-- Latest compiled and minified CSS -->
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">

            <!-- jQuery library -->
            <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

            <!-- Latest compiled JavaScript -->
            <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

        <title>
            PRUEBA PARA TFG - VIDEOJUEGO NARRATIVO
        </title>

    </header>

    <body>
            <p class="text-center">PRUEBA PARA TFG - VIDEOJUEGO NARRATIVO</p>

            <div class="col-xs-12">
                <div class="form-group">
                        <label for="comment">INTRODUCE UNA PALABRA:</label>
                        <textarea class="form-control" rows="5" id="comment"></textarea>
                        <button type="button" class="btn btn-dark" id="button">Escuchar</button>
                </div>
            </div>

           
            <audio controls id="source" src="">
                    Your browser does not support the audio element.
            </audio>
    </body>


    <script>

        const URL="https://voicerss-text-to-speech.p.rapidapi.com/?&key=fed840ae6af4495d8aab93e3cded0c38&hl=es-es&b64=true"

        $( document ).ready(function() {
           $('#source').hide();
        });

    $("#button").click(function() {


        $("#source").show();
        var text = $('#comment').val();
		var llamada = URL + "&SRC='"+ text +"'";

        var callToAPI = {
            "async": true,
            "crossDomain": true,
            "url": llamada,
            "method": "GET",
            "headers": {
                "x-rapidapi-host": "voicerss-text-to-speech.p.rapidapi.com",
                "x-rapidapi-key": "5d5f7a227dmsh5c5d3b27197990dp175cf8jsn531456284eb3",
            }
        }

        $.ajax(callToAPI).done(function (response) {
            console.log(response.length);
			//response = response.substring(0,response.length/2)
            $('audio').attr('src', response);
            $('audio')[0].load();
            $('audio')[0].play();
			llamada = "";
        });
        
        $('audio')[0].onended = function() {
            $('#source').hide();
        }
        
        
    });

    


    

    </script>




</html>